<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <div th:include="fragments/layout :: head" th:with="pageTitle='Spend Profile'" th:remove="tag" />
</head>
<body th:class="${(param.view != null and param.view[0] == 'full' ? 'app-overview full-width' : 'app-overview ')}">

<div th:include="fragments/layout :: body-start" th:remove="tag"/>
<div th:include="fragments/layout :: global-header" th:remove="tag"/>


<main id="content">
    <div th:include="fragments/layout :: main-content-start" th:remove="tag"/>


    <div class="page-title">
            <div th:include="fragments/elements :: project-title (projectId=${model.applicationId}, projectName=${model.projectName})"
             th:remove="tag"/>
        <h1 class="heading-xlarge">Spend Profile</h1>
    </div>

    <div th:if="${model.submitted}" th:remove="tag">
        <div class="success-alert extra-margin-bottom">
            <p><strong>All project spend profiles have been submitted to Innovate UK</strong></p>
        </div>
    </div>

    <p>This overview shows the spend profile status of each partner in your project.</p>

    <div th:if="${model.submitted}" th:remove="tag">
        <h2 class="heading-medium">Profile spend</h2>
        <p>All spend profiles have been submitted to Innovate UK and the Monitoring Officer assigned to this application.
           You may view the submitted spend profiles.</p>

        <a href="/prototypes/3100-spend?task=reviewProject&#38;status=Submitted">Total project profile spend</a>

    </div>


    <h2 class="heading-medium">Partner progress</h2>


    <div class="extra-margin-bottom">
        <table>
            <thead>
            <tr>
                <th scope="col" style="width: 50%">Partner</th>
                <th scope="col" style="width: 50%">Progress</th>
            </tr>
            </thead>
            <tbody>

            <tr th:unless="${#lists.isEmpty(model.partnerOrganisations) and partnerSpendProfileProgress != null}"
                th:each="partnerProgress : ${model.partnerSpendProfileProgress}">

                <td>
                    <div th:each="partner : ${model.partnerOrganisations}"
                         th:if="${partner.name.equals(partnerProgress.key) }">

                        <div th:if="${partnerProgress.value or model.editablePartners.get(partnerProgress.key)}" th:remove="tag">
                            <a th:href="@{/project/{id}/partner-organisation/{organisationId}/spend-profile/review(id=${model.projectId}, organisationId=${partner.id})}"
                               th:text="${partnerProgress.key}"/>
                        </div>

                        <div th:unless="${partnerProgress.value or model.editablePartners.get(partnerProgress.key)}" th:remove="tag">
                            <span th:text="${partnerProgress.key}"></span>
                        </div>
                    </div>
                </td>

                <td th:if="${!partnerProgress.value}">
                    In progress
                </td>
                <div th:if="${partnerProgress.value }" th:remove="tag">
                    <td>
                        <span class="yes">Complete</span>
                    </td>
                </div>

            </tr>

            </tbody>
        </table>
    </div>

    <div th:if="${model.markAsComplete and !model.submitted}" th:remove="tag">

        <p class="extra-margin">Please review each partner's spend profile once they are marked as complete. You must
            make sure they fit the timelines of your project plan.</p>

        <a th:href="@{/project/{id}/spend-profile/total(id=${model.projectId})}" class="button">Review and submit total project profile
            spend</a>

    </div>

    <div th:include="fragments/layout :: main-content-end" th:remove="tag"/>
</main>

<div th:include="fragments/layout :: footer" th:remove="tag"/>
<div th:include="fragments/layout :: body-end" th:remove="tag"/>

</body>
</html>
