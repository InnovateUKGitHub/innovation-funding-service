<!DOCTYPE html>
<html lang="en" class="govuk-template" xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Dashboard',hasFormErrors=${#fields.hasErrors('${form.*}')}" />
</head>

<body class="govuk-template__body app-dashboard">

<th:block th:insert="fragments/layout :: body-start" />
<th:block th:insert="fragments/layout :: global-header" />
<div class="govuk-width-container">
    <th:block th:insert="fragments/layout :: phase-banner" />

    <main class="govuk-main-wrapper" id="main-content" role="main">
        <div th:if="${#fields.hasErrors('${form.*}')}" class="govuk-error-summary" aria-labelledby="error-summary-title"
             role="alert"
             tabindex="-1"
             data-module="govuk-error-summary">
            <h2 class="govuk-error-summary__title" id="error-summary-title">There is a problem</h2>
            <div class="govuk-error-summary__body">
                <th:block th:insert="fragments/elements :: error-summary-list(form)"/>
            </div>
        </div>
        <div class="my-applications">
            <th:block th:insert="fragments/layout :: page-title" th:with="pageTitle='Project setup',size='govuk-heading-l'" />
            <form id="mo-dashboard-form" th:object="${form}" method="post" novalidate="novalidate" th:action="@{${#ifsUtil.formPostUri(#httpServletRequest)}}">
                <div class="govuk-grid-row">
                    <div class="govuk-grid-column-one-third">
                    <form id="filter-projects" method="GET">
                        <fieldset class="govuk-fieldset">
                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s govuk-!-margin-0">
                                <h2 class="govuk-fieldset__heading">
                                    Filter projects
                                </h2>
                            </legend>
                            <hr class="govuk-section-break govuk-section-break--visible" />
                            <div class="govuk-form-group govuk-!-margin-top-6">
                                <label class="govuk-label" for="keywordSearch">Keywords</label>
                                <th:block th:if="${#fields.hasErrors('keywordSearch')}">
                                    <span class="govuk-error-message" th:each="err : ${#fields.errors('keywordSearch')}" th:text="${err}"></span>
                                </th:block>
                                <input class="govuk-input"
                                       id="keywordSearch"
                                       th:field="*{keywordSearch}"
                                       type="text"
                                       minlength="3"
                                       maxlength="100"
                                       th:attr="data-minlength-errormessage=#{validation.modashboard.filterprojects.keywordsearch.min.length},
                                                data-maxlength-errormessage=#{validation.modashboard.filterprojects.keywordsearch.max.length}">
                            </div>
                            <div class="govuk-form-group">
                                <h2 class="govuk-heading-s govuk-!-margin-bottom-2">
                                    Filter projects
                                </h2>
                                <div class="govuk-checkboxes">
                                    <div class="govuk-checkboxes__item">
                                        <input id="projectInSetup"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="projectInSetup"
                                               th:field="${form.projectInSetup}"
                                        />
                                        <label for="projectInSetup" class="govuk-label govuk-checkboxes__label">
                                            <span th:unless="${model.isMoDashboardFilterEnabled()}">In setup</span>
                                            <span th:if="${model.isMoDashboardFilterEnabled()}" th:text="'In setup (' + ${model.monitoringOfficerSummaryView.inSetupProjectCount} + ')'">In setup (18)</span>
                                        </label>
                                    </div>
                                    <div class="govuk-checkboxes__item">
                                        <input id="previousProject"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="previousProject"
                                               th:field="${form.previousProject}"
                                        />
                                        <label for="previousProject" class="govuk-label govuk-checkboxes__label">
                                            <span th:unless="${model.isMoDashboardFilterEnabled()}">Previous</span>
                                            <span th:if="${model.isMoDashboardFilterEnabled()}" th:text="'Previous (' + ${model.monitoringOfficerSummaryView.previousProjectCount} + ')'">Previous (5)</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div th:if="${model.isMoDashboardFilterEnabled()}"
                                 class="govuk-form-group govuk-!-margin-top-7">
                                <h2 class="govuk-heading-s govuk-!-margin-bottom-2">
                                    Documents status
                                </h2>
                                <div class="govuk-checkboxes">
                                    <div class="govuk-checkboxes__item">
                                        <input id="documentsComplete"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="documentsComplete"
                                               th:field="${form.documentsComplete}"
                                        />
                                        <label for="documentsComplete" class="govuk-label govuk-checkboxes__label">
                                            <span th:text="'Complete (' + ${model.monitoringOfficerSummaryView.documentsCompleteCount} + ')'">Complete (7)</span>
                                        </label>
                                    </div>
                                    <div class="govuk-checkboxes__item">
                                        <input id="documentsIncomplete"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="documentsIncomplete"
                                               th:field="${form.documentsIncomplete}"
                                        />
                                        <label for="documentsIncomplete" class="govuk-label govuk-checkboxes__label">
                                            <span th:text="'Incomplete (' + ${model.monitoringOfficerSummaryView.documentsIncompleteCount} + ')'">Incomplete (5)</span>
                                        </label>
                                    </div>
                                    <div class="govuk-checkboxes__item">
                                        <input id="documentsAwaitingReview"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="documentsAwaitingReview"
                                               th:field="${form.documentsAwaitingReview}"
                                        />
                                        <label for="documentsAwaitingReview" class="govuk-label govuk-checkboxes__label">
                                            <span th:text="'Awaiting review (' + ${model.monitoringOfficerSummaryView.documentsAwaitingReviewCount} + ')'">Awaiting review (7)</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div th:if="${model.isMoDashboardFilterEnabled()}"
                                 class="govuk-form-group govuk-!-margin-top-7">
                                <h2 class="govuk-heading-s govuk-!-margin-bottom-2">
                                    Spend profile status
                                </h2>
                                <div class="govuk-checkboxes">
                                    <div class="govuk-checkboxes__item">
                                        <input id="spendProfileComplete"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="spendProfileComplete"
                                               th:field="${form.spendProfileComplete}"
                                        />
                                        <label for="spendProfileComplete" class="govuk-label govuk-checkboxes__label">
                                            <span th:text="'Complete (' + ${model.monitoringOfficerSummaryView.spendProfileCompleteCount} + ')'">Complete (7)</span>
                                        </label>
                                    </div>
                                    <div class="govuk-checkboxes__item">
                                        <input id="spendProfileIncomplete"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="spendProfileIncomplete"
                                               th:field="${form.spendProfileIncomplete}"
                                        />
                                        <label for="spendProfileIncomplete" class="govuk-label govuk-checkboxes__label">
                                            <span th:text="'Incomplete (' + ${model.monitoringOfficerSummaryView.spendProfileIncompleteCount} + ')'">Incomplete (5)</span>
                                        </label>
                                    </div>
                                    <div class="govuk-checkboxes__item">
                                        <input id="spendProfileAwaitingReview"
                                               class="govuk-checkboxes__input"
                                               type="checkbox"
                                               value="spendProfileAwaitingReview"
                                               th:field="${form.spendProfileAwaitingReview}"
                                        />
                                        <label for="spendProfileAwaitingReview" class="govuk-label govuk-checkboxes__label">
                                            <span th:text="'Awaiting review (' + ${model.monitoringOfficerSummaryView.spendProfileAwaitingReviewCount} + ')'">Awaiting review (7)</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="govuk-form-group govuk-!-margin-top-9">
                                <button class="govuk-button" id="update-documents-results-button">Update results</button>
                            </div>
                        </fieldset>
                    </form>
                </div>
                    <div class="govuk-grid-column-two-thirds">
                        <h2 class="govuk-heading-s govuk-!-margin-0" th:text="${model.projectCount == 1 ? '1 project' : model.projectCount + ' projects' }">37 projects</h2>
                        <th:block th:if="${model.emptyResults}">
                            <div class="govuk-!-margin-bottom-6">
                                <h2 class="govuk-heading-l">No results found</h2>
                                <ul class="govuk-list govuk-list--bullet">
                                    <li>please check your search criteria and try again</li>
                                </ul>
                            </div>
                        </th:block>
                        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible govuk-!-margin-top-0" />
                        <th:block th:unless="${model.emptyResults}">
                            <div class="progress-list progress-list--individual-blocks">
                                <ul>
                                    <li th:each="projectView : ${model.projects}">
                                        <div class="task">
                                            <h3 class="govuk-heading-s">
                                                <a th:href="${projectView.linkUrl}" th:text="${projectView.title}" class="govuk-link">PROJECT NAME</a>
                                            </h3>
                                            <ul class="application-details">
                                                <li>Project number: <span th:text="${projectView.applicationNumber}">PROJECT NUMBER</span></li>
                                                <li>Competition: <span th:text="${projectView.competitionTitle}">COMPETITION NAME</span></li>
                                            </ul>
                                        </div>
                                        <div class="status">
                                            <th:block th:unless="${projectView.projectState.complete}">
                                                <strong class="status-msg msg-progress">
                                                Monitor project
                                            </strong>
                                            </th:block>
                                            <th:block th:if="${projectView.projectState.complete}">
                                                <p th:if="${projectView.liveOrCompletedOffline}" class="govuk-body status-msg msg-progress">Live project</p>
                                                <p th:if="${projectView.unsuccessful}" class="govuk-body status-msg msg-progress msg-negative">Unsuccessful</p>
                                                <p th:if="${projectView.withdrawn}" class="govuk-body status-msg msg-progress">Withdrawn</p>
                                            </th:block>
                                        </div>

                                        <div th:if="${model.isMoDashboardFilterEnabled() and projectView.monitoringDashboardSectionsViewModel.documentSectionViewModel.hasDocumentSection}"
                                             class="task govuk-!-margin-bottom-0">
                                            <ul>
                                                <li>
                                                    <hr class="govuk-section-break govuk-section-break--visible govuk-!-margin-top-4 govuk-!-margin-bottom-3"/>
                                                    <div class="task">
                                                        <h4 class="govuk-!-margin-top-0 govuk-!-margin-bottom-0">
                                                            <a th:if="${projectView.monitoringDashboardSectionsViewModel.documentSectionViewModel.hasDocumentForReview}"
                                                               th:href="${projectView.monitoringDashboardSectionsViewModel.documentSectionViewModel.getDocumentLinkUrl}"
                                                               class="govuk-link">Documents</a>

                                                            <p th:unless="${projectView.monitoringDashboardSectionsViewModel.documentSectionViewModel.hasDocumentForReview}"
                                                               class="govuk-!-margin-top-0 govuk-!-margin-bottom-0">
                                                                Documents</p>
                                                        </h4>
                                                    </div>

                                                    <div th:if="${projectView.monitoringDashboardSectionsViewModel.documentSectionViewModel.hasDocumentSection}"
                                                         th:insert="project/fragments :: mo-project-setup-status-indicator(${projectView.monitoringDashboardSectionsViewModel.documentSectionViewModel.documentSectionStatus})"></div>
                                                </li>
                                            </ul>
                                        </div>

                                        <div th:if="${model.isMoDashboardFilterEnabled() and projectView.monitoringDashboardSectionsViewModel.spendProfileSectionViewModel.hasSpendProfileSection}"
                                             class="task govuk-!-margin-bottom-0">
                                            <ul>
                                                <li>
                                                    <hr class="govuk-section-break govuk-section-break--visible govuk-!-margin-top-4 govuk-!-margin-bottom-3"/>
                                                    <div class="task">
                                                        <h4 class="govuk-!-margin-top-0 govuk-!-margin-bottom-0">
                                                            <a th:if="${projectView.monitoringDashboardSectionsViewModel.spendProfileSectionViewModel.hasSpendProfileForReview}"
                                                               th:href="${projectView.monitoringDashboardSectionsViewModel.spendProfileSectionViewModel.getSpendProfileLinkUrl}"
                                                               class="govuk-link">Spend profile</a>

                                                            <p th:unless="${projectView.monitoringDashboardSectionsViewModel.spendProfileSectionViewModel.hasSpendProfileForReview}"
                                                               class="govuk-!-margin-top-0 govuk-!-margin-bottom-0">
                                                                Spend profile</p>
                                                        </h4>
                                                    </div>

                                                    <div th:if="${projectView.monitoringDashboardSectionsViewModel.spendProfileSectionViewModel.hasSpendProfileSection}"
                                                         th:insert="project/fragments :: mo-project-setup-status-indicator(${projectView.monitoringDashboardSectionsViewModel.spendProfileSectionViewModel.spendProfileStatus})"></div>
                                                </li>
                                            </ul>
                                        </div>

                                    </li>
                                </ul>
                            </div>
                        </th:block>
                        <th:block th:insert="fragments/elements :: general-pagination(pagination=${modelpagination})" />
                    </div>
                </div>
              </form>
        </div>
    </main>
</div>

<th:block th:insert="fragments/layout :: footer" />
<th:block th:insert="fragments/layout :: body-end" />
<th:block th:insert="fragments/service-layout :: body-end" />
</body>

</html>
