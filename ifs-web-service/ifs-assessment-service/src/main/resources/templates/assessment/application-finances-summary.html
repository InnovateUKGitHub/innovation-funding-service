<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
    <head>
        <div th:include="fragments/layout :: head" th:with="pageTitle='Funding'"  th:remove="tag"></div>
    </head>

    <body th:with="context='assessment'" class="assessment assessment-finances-summary">
        <div th:include="fragments/layout :: body-start" th:remove="tag"></div>
        <div th:include="fragments/layout :: global-header" th:remove="tag"></div>

        <main id="content">
            <div th:include="fragments/layout :: main-content-start" th:remove="tag"></div>
            <div th:include="fragments/assessment :: assessment-header-sub" th:with="linkTitle='Back to your assessment overview',linkClass='link-back',linkUrl=@{/{id}(id=${assessmentId})},daysPercentage=${currentCompetition.assessmentDaysLeftPercentage},daysLeft=${currentCompetition.assessmentDaysLeft}" th:remove="tag" />

            <div class="page-title">
                <div th:include="fragments/elements :: application-title (application=${currentApplication}, competition=${currentCompetition})" th:remove="tag" />
                <h1 class="heading-xlarge">Funding</h1>
            </div>

            <h2 class="heading-medium">Finances summary</h2>
            <div class="form-group finances-summary">
                <div style="overflow: auto;">
                    <table>
                        <thead>
                            <tr>
                                <td />
                                <th scope="col" class="numeric">Total costs</th>
                                <th scope="col" class="numeric width-small">
                                % Grant
                            </th>
                            <th scope="col" class="numeric width-small-medium">
                                Funding sought
                            </th>
                            <th scope="col" class="numeric width-medium">
                                Other public sector funding
                            </th>
                            <th scope="col" class="numeric width-small-medium">
                                Contribution to project
                            </th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr th:each="applicationOrganisation : ${applicationOrganisations}">
                                <th scope="row">
                                    <div>
                                        <div th:text="${applicationOrganisation.name}" />
                                        <div th:if="${applicationOrganisation.id.equals(leadOrganisation.id)}">
                                            <small>Lead organisation</small>
                                        </div>
                                        <div th:unless="${applicationOrganisation.id.equals(leadOrganisation.id)}">
                                            <small>Partner</small>
                                        </div>
                                    </div>
                                </th>
                                <div th:with="organisationFinance=${organisationFinances.get(applicationOrganisation.id)}" th:if="${organisationFinances.containsKey(applicationOrganisation.id)}" th:remove="tag">
                                    <td class="numeric bold" th:text="'£'+${#numbers.formatDecimal(organisationFinance.total, 0, 'COMMA', 0, 'POINT')}" />
                                    <td class="numeric" th:text="${organisationFinance.grantClaimPercentage}+'%'"/>
                                    <td class="numeric" th:text="'£'+${#numbers.formatDecimal(organisationFinance.totalFundingSought, 0, 'COMMA', 0, 'POINT')}"/>
                                    <td class="numeric" th:text="'£'+${#numbers.formatDecimal(organisationFinance.totalOtherFunding, 0, 'COMMA', 0, 'POINT')}"/>
                                    <td class="numeric" th:text="'£'+${#numbers.formatDecimal(organisationFinance.totalContribution, 0, 'COMMA', 0, 'POINT')}"/>
                                </div>
                            </tr>
                            <tr>
                                <th scope="row">Total</th>
                                <td class="numeric bold" th:text="'£'+${#numbers.formatDecimal(financeTotal, 0, 'COMMA', 0, 'POINT')}" />
                                <td />
                                <td class="numeric" th:text="'£'+${#numbers.formatDecimal(totalFundingSought, 0, 'COMMA', 0, 'POINT')}" />
                                <td class="numeric" th:text="'£'+${#numbers.formatDecimal(totalOtherFunding, 0, 'COMMA', 0, 'POINT')}" />
                                <td class="numeric" th:text="'£'+${#numbers.formatDecimal(totalContribution, 0, 'COMMA', 0, 'POINT')}" />
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <h2 class="heading-medium extra-margin">Project cost breakdown</h2>
            <div th:include="finance/finance-summary :: financial_summary_table" th:remove="tag"/>

            <div th:include="fragments/layout :: main-content-end" th:remove="tag"></div>
        </main>

        <div th:include="fragments/layout :: footer" th:remove="tag"></div>
        <div th:include="fragments/layout :: body-end" th:remove="tag"></div>
    </body>
</html>
