<!DOCTYPE html>
<html lang="en" class="govuk-template" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block
        th:with="applicationName=${#strings.isEmpty(model.applicationName)} ? #{ifs.application.no_title} : ${model.applicationName}">
        <th:block th:insert="fragments/layout :: head" th:with="pageTitle=|Your fEC model - ${applicationName}|"/>
    </th:block>
</head>
<body class="govuk-template__body your-fec-model app-form">
<th:block th:insert="fragments/layout :: global-header"/>
<th:block th:insert="fragments/layout :: body-start" />

<div class="govuk-width-container">

    <th:block th:insert="fragments/layout :: header-sub"
              th:with="linkTitle='Back to your project finances',linkClass='link-back',linkUrl=${model.financesUrl}"/>
    <main class="govuk-main-wrapper" id="main-content" role="main">
        <div th:if="${#fields.hasErrors('${form.*}')}" class="govuk-error-summary"
             aria-labelledby="error-summary-title"
             role="alert"
             tabindex="-1"
             data-module="govuk-error-summary">
            <h2 class="govuk-error-summary__title" id="error-summary-title">There is a problem</h2>
            <th:block th:insert="fragments/elements :: error-summary-list(form)"/>
        </div>

        <th:block
            th:with="applicationName=${#strings.isEmpty(model.applicationName)} ? #{ifs.application.no_title} : ${model.applicationName}">
            <th:block th:insert="fragments/layout :: page-title"
                      th:with="pageTitle='Your fEC model',subTitle=${applicationName},size='govuk-heading-xl'"/>
        </th:block>
        <form th:object="${form}"
              th:action="@{${#ifsUtil.formPostUri(#httpServletRequest)}}"
              enctype="multipart/form-data"
              novalidate="novalidate"
              method="POST">

        <input id="fecModelEnabled-yes"
               name="fecModelEnabled"
               type="hidden"
               value="true"
               required="required" />

        <th:block th:unless="${model.readOnly}">

            <div id="upload-fec" class="upload-section" style="background:inherit;padding:0;">
                 <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                             Upload your fEC certificate
                 </legend>
                  <p class="govuk-hint">This is needed to verify your fEC funding model. </p>
                    <details class="govuk-details govuk-!-margin-bottom-1" role="group">
                        <summary class="govuk-details__summary">
                            <span class="govuk-details__summary-text">What can I upload?</span>
                        </summary>
                        <div class="govuk-details__text">
                            <p class="govuk-body govuk-!-margin-bottom-0  govuk-!-font-weight-bold">Your fEC certificate must be:</p>
                               <ul class="govuk-list govuk-list--bullet">
                                  <li>in portable document format (PDF) </li>
                                  <li>less than 10 MB in size</li>
                              </ul>
                        </div>
                    </details>
                  <div class="govuk-form-group">
                    <th:block th:insert="question-type/types :: fileupload-fragment(${model.readOnly ? 'readonly' : 'edit'},
                            @{/application/{applicationId}/form/{applicationFinanceId}/view-fec-certificate(applicationId=${model.applicationId},applicationFinanceId=${model.applicationFinanceId})},
                            ${form.fecCertificateFileName},
                            fecCertificateFile,
                            fecCertificateFile,
                            true,
                            remove_fecCertificateFile,
                            upload_fecCertificateFile)"/>
                 </div>
            </div>

            <div class="govuk-form-group govuk-!-margin-top-6"
                  th:classappend="${#fields.hasErrors('fecCertExpiry*')} ? 'govuk-form-group--error'">
                 <fieldset class="govuk-fieldset" aria-describedby="fec-hint">
                     <legend id="fecCertExpiryDate" class="govuk-fieldset__legend govuk-fieldset__legend--s">
                         When does your fEC certificate expire?
                         <p id="fec-hint" class="govuk-hint">
                             For example, 10 4 2022. If your fEC certificate expires before the Funder's panel, you must email an updated fEC certificate to <b>support@iuk.ukri.org</b> four weeks before the panel takes place.
                         </p>
                     </legend>


                     <th:block th:if="${#fields.hasErrors('fecCertExpiry*')}">
                         <span class="govuk-error-message" th:each="err : ${#fields.errors('fecCertExpiry*')}" th:text="${err}"></span>
                     </th:block>

                     <div class="date-group"
                          th:attr="data-date-invalid-errormessage=#{validation.standard.date.format}">
                         <div class="day">
                             <label class="govuk-label" for="fecCertExpiryDay">
                                 <span>Day</span>
                             </label>
                             <input class="govuk-input govuk-input--width-3"
                                    type="number"
                                    id="fecCertExpiryDay"
                                    placeholder="DD"
                                    required="required"
                                    value="1"
                                    data-date=""
                                    data-autosave-disabled=""
                                    th:classappend="${#fields.hasErrors('fecCertExpiryDay')} ? 'govuk-input--error'"
                                    th:field="*{fecCertExpiryDay}"
                                    th:attr="data-required-errormessage=#{validation.fundingForm.date.format}">
                         </div>

                         <div class="month">
                             <label class="govuk-label" for="fecCertExpiryMonth">
                                 <span>Month</span>
                             </label>
                             <input class="govuk-input govuk-input--width-3"
                                    type="number"
                                    id="fecCertExpiryMonth"
                                    min="1"
                                    max="12"
                                    placeholder="MM"
                                    required="required"
                                    data-date=""
                                    data-autosave-disabled=""
                                    th:classappend="${#fields.hasErrors('fecCertExpiryMonth')} ? 'govuk-input--error'"
                                    th:field="*{fecCertExpiryMonth}"
                                    th:attr="data-required-errormessage=#{validation.fundingForm.date.month}">
                         </div>

                         <div class="year">
                             <label class="govuk-label" for="fecCertExpiryYear">
                                 <span>Year</span>
                             </label>
                             <input class="govuk-input govuk-input--width-3"
                                    type="number"
                                    id="fecCertExpiryYear"
                                    placeholder="YYYY"
                                    required="required"
                                    data-date=""
                                    data-autosave-disabled=""
                                    th:classappend="${#fields.hasErrors('fecCertExpiryYear')} ? 'govuk-input--error'"
                                    th:field="*{fecCertExpiryYear}"
                                    th:attr="data-required-errormessage=#{validation.fundingForm.date.year}">
                         </div>
                     </div>

                 </fieldset>
             </div>

        </th:block>

        <h3 class="govuk-heading-m govuk-!-margin-top-9">Funding model</h3>
        <div class="govuk-grid-row govuk-table__cell">
            <h3 class="govuk-heading-s govuk-grid-column-one-third">
                Will you be using the full economic costing (fEC) funding model?
            </h3>
            <div class="govuk-grid-column-one-third">
                <p class="govuk-list readonly-data govuk-!-margin-top-0 govuk-!-margin-bottom-5">Yes</p>
            </div>
            <div class="alignright govuk-grid-column-one-third">
                <button id="mark_as_incomplete" type="submit" name="mark-as-incomplete" class="button-clear" value="true">Change</button>
            </div>
        </div>

        <div class="form-footer govuk-!-margin-top-9" th:if="${model.open}">
            <div class="form-footer__actions">
                 <button id="mark_as_complete" th:unless="${model.complete}" type="submit" name="mark-as-complete"
                            class="button-clear" value="true">Mark as complete
                 </button>
            </div>
        </div>

        <div>
             <button type="submit" th:unless="${model.readOnly}"
                        class="govuk-!-margin-top-6 govuk-button">
                    Save and return to project finances
              </button>
        </div>

        </form>
        <th:block th:fragment="main-content-end">
            <p class="govuk-body govuk-!-margin-top-9 user-feedback"><span class="govuk-!-font-weight-bold">Need help with this service?</span>
                <a class="govuk-link" href="/info/contact">Contact us</a></p>
        </th:block>
    </main>

</div>
<th:block th:insert="fragments/layout :: footer"/>
<th:block th:insert="fragments/layout :: body-end"/>
<th:block th:insert="fragments/service-layout :: body-end"/>
'
</body>
</html>
