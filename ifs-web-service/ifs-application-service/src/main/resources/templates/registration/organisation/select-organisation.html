<!DOCTYPE html>
<html lang="en" class="govuk-template" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Start new application',hasFormErrors=${#fields.hasErrors('${form.*}')}" />
</head>
<body class="govuk-template__body create-application-eligibility">

<th:block th:insert="fragments/layout :: body-start" />
<th:block th:insert="fragments/layout :: global-header" />

<div class="govuk-width-container">
    <th:block th:insert="fragments/layout :: phase-banner" />
    <th:block th:insert="fragments/layout :: header-sub" th:with="linkTitle='Back',linkUrl='/organisation/create/international-organisation',currentApplication=${currentApplication},dynamicBackLink=${true}" />

    <main class="govuk-main-wrapper" id="main-content" role="main">
        <th:block th:insert="fragments/layout :: page-title" th:with="pageTitle=${model.canSelectOrganisation() ? 'Select your organisation' : 'Your organisation'},subTitle=${subtitle},size='govuk-heading-xl'" />

        <div th:if="${#fields.hasErrors('${form.*}')}"
             class="govuk-error-summary"
             role="alert"
             aria-labelledby="error-summary-heading"
             tabindex="-1">
            <h2 class="govuk-error-summary__title"
                id="error-summary-heading">
                We were unable to save your changes.
            </h2>
            <th:block th:insert="fragments/elements :: error-summary-list(form)" />
        </div>


        <th:block th:unless="${model.canSelectOrganisation()}">
            <p class="govuk-body govuk-!-margin-bottom-0" th:unless="${model.collaboratorJourney}">This is the organisation that will lead the application unless you apply with a different organisation.</p>
            <p class="govuk-body govuk-!-margin-bottom-0" th:if="${model.collaboratorJourney}">This is the organisation that you will join the <th:block th:text="${model.applicantJourney ? 'application' :  'project'}">application</th:block> with.</p>
        </th:block>

        <th:block th:if="${model.canSelectOrganisation()}">
            <p class="govuk-body govuk-!-margin-bottom-0" th:unless="${model.collaboratorJourney}">Choose the lead organisation or apply with a different organisation.</p>
            <p class="govuk-body govuk-!-margin-bottom-0" th:if="${model.collaboratorJourney}">Choose your organisation or join with a different organisation.</p>
            <p class="govuk-body govuk-hint" th:if="${model.internationalJourney}">You have used these international organisations in the past.</p>
            <p class="govuk-body govuk-hint" th:unless="${model.internationalJourney}">You have used these UK-based organisations in the past.</p>
        </th:block>

        <form th:object="${form}" class="govuk-!-margin-top-5" id="save-organisation-form" th:action="@{/organisation/select}" method="POST">
            <th:block th:if="${model.canSelectOrganisation()}">
                <div class="govuk-form-group">
                    <div class="govuk-radios">
                        <div class="govuk-radios__item" th:each="choice : ${model.choices}">
                            <input class="govuk-radios__input"
                                   th:field="*{selectedOrganisationId}"
                                   th:value="${choice.id}"
                                   type="radio"
                                   required="required"
                                   th:attr="data-required-errormessage=#{validation.standard.organisation.required}" />
                            <label class="govuk-label govuk-radios__label" th:for="${#ids.prev('selectedOrganisationId')}">
                                <span class="govuk-label--s" th:text="${choice.name}" />
                                <span class="govuk-hint" th:text="${choice.type}" />
                            </label>
                        </div>
                    </div>
                </div>
            </th:block>
            <th:block th:unless="${model.canSelectOrganisation()}" th:with="organisation=${model.onlyOrganisation()}">
                <dl class="govuk-list readonly-data">
                    <dt th:text="${organisation.name}"></dt>
                    <dd th:text="${organisation.type}"></dd>
                </dl>
                <input name="selectedOrganisationId" th:value="${organisation.id}" type="hidden" />
            </th:block>

            <p class="govuk-body">
                <a class="govuk-link" th:unless="${model.collaboratorJourney}" th:href="${model.newOrganisationUrl}">Apply with a different organisation</a>
                <a class="govuk-link" th:if="${model.collaboratorJourney}" th:href="${model.newOrganisationUrl}">Join with a different organisation</a>
            </p>

            <button type="submit" id="save-organisation-button" class="govuk-button govuk-!-margin-top-6">Save and continue</button>
        </form>

        <th:block th:insert="fragments/layout :: main-content-end" />
    </main>

</div>

<th:block th:insert="fragments/layout :: footer" />
<th:block th:insert="fragments/layout :: body-end" />
<th:block th:insert="fragments/service-layout :: body-end" />
</body>
</html>
