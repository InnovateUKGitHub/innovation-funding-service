<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Competition Overview'" />
</head>
<body th:with="context='applicant'" class="competition-overview">
    <th:block th:insert="fragments/layout :: global-header" />

    <th:block th:insert="fragments/layout :: body-start" />
    <main id="content">
        <th:block th:insert="fragments/layout :: main-content-start" />
        <th:block th:insert="fragments/layout :: header-sub" th:with="linkTitle='Back to all competitions',linkClass='link-back',linkUrl='/competition/search'" />

        <p class="subtitle">Funding competition</p>
        <h1 class="heading-large no-margin" th:text="${model.competitionTitle}"></h1>

        <p class="wysiwyg-styles" ifs:utext="${model.shortDescription}"></p>

        <ul class="list">
            <li><strong>Competition opens:</strong> <span th:text="${#temporals.format(model.competitionOpenDate, 'EEEE d MMM yyyy')}"></span></li>

            <li th:unless="${model.nonIfs}" th:with="date=${#temporals.format(model.competitionCloseDate, 'EEEE d MMMM yyyy')},
                         time=${#strings.toLowerCase(#temporals.format(model.competitionCloseDate, ' h:mma'))}">
                <strong>Competition closes:</strong> <th:block th:text="${date + ' ' + time}"/></li>

            <li th:if="${model.nonIfs}" th:with="date=${#temporals.format(model.registrationCloseDate, 'EEEE d MMMM yyyy')},
            time=${#strings.toLowerCase(#temporals.format(model.competitionCloseDate, ' h:mma'))}">
                <strong>Registration closes:</strong> <th:block th:text="${date + ' ' + time}"/></li>

        </ul>
        <div>
            <div th:unless="${model.showApplyButton}" class="warning-alert">
                This competition is now closed.
            </div>
            <th:block th:unless="${model.nonIfs}">
                <p class="extra-margin-top" th:with="loggedInUrl=@{/application/create-authenticated/{competitionId}(competitionId=${model.competitionId})},notLoggedInUrl=@{/application/create/check-eligibility/{competitionId}(competitionId=${model.competitionId})}">
                    <a class="button"
                       th:if="${model.showApplyButton}"
                       th:href="${model.userIsLoggedIn ? loggedInUrl : notLoggedInUrl}">
                        Start new application
                    </a>
                    <button th:unless="${model.showApplyButton}" class="button" disabled="disabled">
                        Start new application
                    </button>
                </p>
                <p class="extra-margin" th:if="${model.showApplyButton}">
                    <th:block th:unless="${model.userIsLoggedIn}">
                        Or <a th:href="@{/}" >Sign in</a> to continue an existing application
                    </th:block>
                    <th:block th:if="${model.userIsLoggedIn}">
                        Or go to your <a th:href="@{/}">dashboard</a> to continue an existing application
                    </th:block>
                </p>
            </th:block>
            <th:block th:if="${model.nonIfs}">
                <p class="extra-margin">
                    <a th:href="${model.nonIfsUrl}" th:if="${model.showApplyButton}" class="button">
                        Register and apply online
                    </a>
                    <button th:unless="${model.showApplyButton}" class="button" disabled="disabled">
                        Register and apply online
                    </button>
                </p>
            </th:block>
        </div>

        <div id="competition-overview-tabs" class="tabs">
            <ul>
                <th:block th:each="sectionType : ${model.allSections}">
                    <li>
                        <a th:href="${'#' + sectionType.path}" th:text="${sectionType.text}"></a>
                    </li>
                </th:block>
            </ul>
            <th:block th:each="section : ${model.allSections}">
                <th:block th:insert="competition/section/fragments :: ${section.path} (section=${section}, competitionId=${model.competitionId})"/>
            </th:block>
        </div>

        <div th:insert="fragments/layout :: main-content-end" th:remove="tag" />
    </main>

    <th:block th:insert="fragments/layout :: footer" />
    <th:block th:insert="fragments/layout :: body-end" />
</body>
</html>
