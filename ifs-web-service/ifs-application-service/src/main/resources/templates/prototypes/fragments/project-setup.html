<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">

<!-- ===========================Prototype index page  =========================== --> 

<div th:fragment="prototype-add-users(addUserType)">
    <table class="extra-margin" th:id="${addUserType+'-table'}" style="display: none">
        <thead>
            <tr>
                <th scope="col" th:id="${addUserType + '-name'}">Name</th>
                <th scope="col" th:id="${addUserType + '-email'}">E-mail</th>
                <th>&nbsp;</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <input type="text" th:name="${'name-'+ addUserType +'1'}" th:id="${'name-'+ addUserType +'1'}" class="form-control width-full" aria-labelledby="user-name" value=""  />
                </td>
                <td>
                    <input type="email" th:name="${'email-'+ addUserType +'1'}" th:id="${'email-'+ addUserType +'1'}" class="form-control width-full" aria-labelledby="user-email" value=""  />
                </td>
                <td class="alignright">
                    <button class="buttonlink no-margin-bottom" th:id="${'invite-' +addUserType}">Invite to project</button> 
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- ===========================Project setup select address=========================== --> 

<div th:fragment="prototype-select-address">
    <fieldset>
        <legend class="visuallyhidden">Operating address</legend>
        <div class="form-block">
            <label class="block-label" for="address-use-org">
                <input id="address-use-org" type="radio" name="project-address-group" value="address-use-org" />
                Use organisation address (<strong>BS1 4NT</strong>)
            </label>
        </div>
        <div class="form-block">
            <label class="block-label" for="address-use-operating">
                <input id="address-use-operating" type="radio" name="project-address-group" value="address-use-operating" />
                Use operating address (<strong>SN1 2UE</strong>)
            </label>
        </div>
        <div class="form-block">
            <label class="block-label" for="address-add-project">
                <input id="address-add-project" type="radio" name="project-address-group" value="address-add-project" />
                Enter an alternative address
            </label>
        </div>
    </fieldset> 


    <div id="selected-address" class="boxed extra-margin" style="display: none;">
        <h3 class="heading-medium no-margin-top" th:text="${(address != null and address == 'bankDetails' ? 'Confirm organisation address' : 'Confirm project location')}">LOCATION TITLE</h3>
        <p><span class="street">Street</span> <br />
            <span class="street2"></span> <br />
            <span class="street3"></span> <br />
            <span class="town">Town</span><br />
            <span class="county">County</span><br />
            <span class="postcode">Postcode</span>
        </p>
    </div>


    <div class="form-group extra-margin" id="postcode-block" style="display: none;">
        <label class="form-label" for="postcode-check">
            <span class="form-label-bold">Postcode</span>
        </label>
        <input class="form-control width-medium" id="postcode-check" name="postcode-check" type="text" />
        <button type="submit" id="postcode-lookup" class="button">Find UK address</button>
        <div>
            <a href="#" id="enter-address-manually">Enter address manually</a>
        </div>
    </div>


    <div class="form-group" id="select-address-block" style="display: none">
        <label class="form-label" for="select-address">
            <span class="form-label-bold">Select your address</span>
        </label>
        <select class="form-control" id="select-address" name="select-address">
            <option value="">SN1 2BD, 1, Station Road, Swindon </option>
            <option value="">SN1 2BD, 1A, Station Road, Swindon  </option>
            <option value="">SN1 2BD, 2, Station Road, Swindon </option>
            <option value="">SN1 2BD, 3, Station Road, Swindon </option>
            <option value="">SN1 2BD, 4, Station Road, Swindon </option>
            <option value="">SN1 2BD, 5, Station Road, Swindon </option>
        </select>
    </div>

    <div th:include="prototypes/fragments/project-setup :: prototype-manual-address" th:remove="tag" />
  
</div>

<!-- ===========================Bank account details=========================== -->
<div th:fragment="prototype-manual-address">
    <fieldset id="address-details" class="extra-margin" th:style="${(user=='internal'?'display: block':'display: none')}">
        <legend class="visuallyhidden">Address details</legend>
        <div class="form-group">
            <label class="form-label" for="street">
                <span class="form-label-bold">Street</span>
            </label>
            <input class="form-control street" id="street" name="street" type="text" th:value="${(param.edit == null ? '':'4 Station Road')}"/>
        </div>
        <div class="form-group">
            <label class="form-label visuallyhidden" for="street-2">
                <span class="form-label-bold">Street line 2</span>
            </label>
            <input class="form-control street-2" id="street-2" name="street-2" type="text" />
        </div>
        <div class="form-group">
            <label class="form-label" for="street-2">
                <span class="form-label-bold visuallyhidden">Street line 3</span>
            </label>
            <input class="form-control street-3" id="street-3" name="street-2" type="text" />
        </div>
        <div class="form-group">
            <label class="form-label" for="town">
                <span class="form-label-bold">Town</span>
            </label>
            <input class="form-control town" id="town" name="town" type="text" th:value="${(param.edit == null ? '':'Swindon')}" />
        </div>
        <div class="form-group">
            <label class="form-label" for="county">
                <span class="form-label-bold">County</span>
            </label>
            <input class="form-control county" id="county" name="county" type="text" th:value="${(param.edit == null ? '':'Wiltshire')}" />
        </div>
        <div class="form-group">
            <label class="form-label" for="postcode">
                <span class="form-label-bold">Postcode</span>
            </label>
            <input class="form-control postcode" id="postcode" name="postcode" type="text" th:value="${(param.edit == null ? '':'SN1 2BD')}" />
        </div>
    </fieldset>
</div>


<!-- ===========================Bank account details=========================== --> 

<div th:fragment="prototype-bank-details">

    <fieldset th:unless="${user == null}">
        
        <h2 class="heading-medium no-margin-bottom">Company details</h2>

        <legend class="visuallyhidden">Company details</legend>

        <div class="form-group extra-margin">
            <label class="form-label" for="company-name">
                <span class="form-label-bold">Company name</span>
            </label>
            <input class="form-control" id="company-name" name="company-name" value="Aptrans Ltd" type="text" />
        </div>
        
        <th:block th:unless="${param.status != null and param.status[0] == 'noCompHouse'}">
            <div class="form-group">
                <label class="form-label" for="companies-house-number">
                    <span class="form-label-bold">Companies House number</span>
                </label>
                <p class="form-hint">For example: 1548965</p>
                <input class="form-control" id="companies-house-number" name="companies-house-number" value="6567388" type="text" />
            </div>
        </th:block>

    </fieldset>

    <fieldset>
        <h2 class="heading-medium no-margin-bottom">Account details</h2>

        <legend class="visuallyhidden">Account details</legend>

        <p class="form-hint" th:unless="${user == 'internal'}">Please enter the bank account that you wish to use during the project.</p>

        <p class="form-hint" th:unless="${user == null}">This is the bank account that the applicant will use for the duration of the project</p>

        <div class="form-group extra-margin">
            <label class="form-label" for="bank-acc-number">
                <span class="form-label-bold">Account number</span>
            </label>
            <p class="form-hint">For example: 1548965</p>
            <input class="form-control" id="bank-acc-number" name="bank-acc-number" value="" type="text" />
        </div>

        <div class="form-group ">
            <label class="form-label" for="bank-sort-code">
                <span class="form-label-bold">Sort code</span>
            </label>
            <p class="form-hint">For example: 311212</p>
            <input class="form-control width-medium" id="bank-sort-code" name="bank-sort-code" value="" type="text" />
        </div>

        <h2 class="heading-medium no-margin-bottom">Billing address</h2>

        <p class="form-hint">This is the billing address connected to this bank account. This is not the address of the bank.</p>

        <div th:include="prototypes/fragments/project-setup :: prototype-select-address" th:with="address='bankDetails'" th:remove="tag" th:unless="${user == 'internal'}"/>

    </fieldset>
</div>


<!-- ===========================Spend profile rows readonly=========================== --> 

<div th:fragment="prototype-spend-row">
    <tr th:class="${(spend == 'high' ? 'error-in-row' : 'spend-ok')}">
        
        <th:block th:if="${type == null}">
            <th scope="row" th:text="${header}" th:id="${#strings.substringBefore(header, ' ')}" class="fix-left">HEADER HERE</th>
        </th:block>
        
        <th:block th:if="${type != null}">
            <th scope="row" th:id="${#strings.substringBefore(header, ' ')}" class="fix-left">
                <span th:text="${header}">HEADER HERE</span>
                <small th:text="${type}">TYPE</small>
            </th>
        </th:block>

        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}" class="separate-cell year">12,500</td>

        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}" class="separate-cell year">12,500</td>

        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}" class="separate-cell year">12,500</td>

        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>

        <td th:text="${total}" class="total fix-right2">450,000</td>
        <td th:text="${total}" class="total eligible fix-right">450,000</td>
    </tr>
</div>

<!-- ===========================Spend profile rows inputs=========================== --> 

<div th:fragment="prototype-spend-row-edit">
    <tr th:class="${(spend == 'high' ? 'error-in-row' : 'spend-ok')}">
        <th scope="row" th:text="${header}" th:id="${#strings.substringBefore(header, ' ')}" class="fix-left">Labour</th>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month1'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month2'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month3'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month4'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month5'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month6'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month7'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month8'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month9'}"/></td>
        <td class="separate-cell year"><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month10'}"/></td>

        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month11'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month12'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month13'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month14'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month15'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month16'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month17'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month18'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month19'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month20'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month21'}"/></td>
        <td class="separate-cell year"><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month22'}"/></td>

        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month23'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month24'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month25'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month26'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month27'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month28'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month29'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month30'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month31'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month32'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month33'}"/></td>
        <td class="separate-cell year"><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month34'}"/></td>

        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month35'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month36'}"/></td>

        <td th:text="${total}" class="total fix-right2">450,000</td>
        <td th:text="${total}" class="total eligible fix-right">450,000</td>
    </tr>
</div>


<!-- ===========================Spend profile ACADEMIC rows readonly=========================== --> 

<div th:fragment="prototype-spend-academic-row">
    <tr th:class="${border != null ? 'cell-border-bottom-divide' : ''}" th:classappend="${(spend == 'high' ? 'error-in-row' : 'spend-ok')}">
        <th th:text="${section}" class="fix-left1">Directly Incured</th>
        <th scope="row" th:text="${header}" th:id="${#strings.substringBefore(header, ' ')}" class="fix-left2">Staff</th>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}" class="separate-cell year">12,500</td>

        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}" class="separate-cell year">12,500</td>

        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>
        <td th:text="${value}" class="separate-cell year">12,500</td>

        <td th:text="${value}">12,500</td>
        <td th:text="${value}">12,500</td>

        <td th:text="${total}" class="total fix-right2">450,000</td>
        <td th:text="${total}" class="total eligible fix-right">450,000</td>
    </tr>
</div>

<!-- ===========================Spend profile academic rows inputs=========================== --> 

<div th:fragment="prototype-spend-academic-row-edit">
    <tr th:class="${border != null ? 'cell-border-bottom-divide' : ''}" th:classappend="${(spend == 'high' ? 'error-in-row' : 'spend-ok')}">
        <th th:text="${section}" class="fix-left1">Directly Incured</th>
        <th scope="row" th:text="${header}" th:id="${#strings.substringBefore(header, ' ')}" class="fix-left2">Staff</th>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month1'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month2'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month3'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month4'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month5'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month6'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month7'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month8'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month9'}"/></td>
        <td class="separate-cell year"><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month10'}"/></td>

        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month11'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month12'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month13'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month14'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month15'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month16'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month17'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month18'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month19'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month20'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month21'}"/></td>
        <td class="separate-cell year"><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month22'}"/></td>

        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month23'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month24'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month25'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month26'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month27'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month28'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month29'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month30'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month31'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month32'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month33'}"/></td>
        <td class="separate-cell year"><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month34'}"/></td>

        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month35'}"/></td>
        <td><input type="text" th:value="${value}" class="form-control" th:attr="aria-labelledby=${#strings.substringBefore(header, ' ')+ ' month36'}"/></td>

        <td th:text="${total}" class="total fix-right2">450,000</td>
        <td th:text="${total}" class="total eligible fix-right">450,000</td>
    </tr>
</div>

<!-- ===========================Messages / Queries  / notes=========================== --> 

<div th:fragment="prototype-post-query(queryType, user)">
    
    <!-- <fieldset th:unless="${queryType == 'note' or user == 'partner'}"> 
        
        <div class="form-group alignright">
            <label for="querySection">Query section</label>
            <select class="form-control">
                <option value="All">All</option>
                <option value="Viability">Viability</option>
                <option value="Eligibility">Eligibility</option>
                <option value="Other">Other</option>
            </select>
        </div>

    </fieldset> -->

    <a th:href="${#httpServletRequest.requestURI + '?action=newQuery'}" id="post-new-query" th:unless="${param.action != null and param.action[0] == 'newQuery' or user == 'partner'}" class="button button-large" th:text="${(queryType == 'query' ? 'Post a new query' : 'Create a new note')}">QUERY TYPE</a>

    <th:block th:if="${param.action != null and param.action[0] == 'newQuery'}" th:unless="${user == 'partner'}" >
    
        <form class="extra-margin" th:action="@{${#httpServletRequest.requestURI}}" method="get">

            <fieldset>
                
                <th:block th:if="${queryType == 'query'}">

                    <legend class="heading-medium">Post new query</legend>
                    
                    <div class="form-group">
                        <label for="queryTitle" class="form-label-bold">Title</label>
                        <input name="queryTitle" id="queryTitle"  class="width-full" required="required" />
                    </div>

                    <div class="form-group">
                        <label for="section" class="form-label-bold">Section</label>
                        <select name="section" id="section" class="form-control">
                            <option value="Viability">Viability</option>
                            <option value="Eligibility">Eligibility</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="query" class="form-label-bold">Query</label>
                        <textarea name="query" id="query" cols="30" rows="10" class="width-full" required="required"></textarea>
                        <div class="count-label alignright">
                            <small>
                                <span class="count-message">Words remaining:</span>
                                <span class="count-down positive" aria-live="polite">400</span>
                            </small>
                        </div>
                    </div>

                </th:block>


                <th:block th:if="${queryType == 'note'}">
                    
                    <legend class="heading-medium">New note</legend>

                    <div class="form-group">
                        <label for="noteTitle" class="form-label-bold">Title</label>
                        <input name="noteTitle" id="noteTitle"  class="width-full" required="required" />
                    </div>


                    <div class="form-group">
                        <label for="noteDetails" class="form-label-bold">Note</label>
                        <textarea name="noteDetails" id="query" cols="30" rows="10" class="width-full" required="required"></textarea>
                        <div class="count-label alignright">
                            <small>
                                <span class="count-message">Words remaining:</span>
                                <span class="count-down positive" aria-live="polite">400</span>
                            </small>
                        </div>
                    </div>

                </th:block>

            </fieldset>

            <fieldset>
                <div class="upload-section unstyled-view">
                    <legend class="heading-small no-margin">Upload supporting documentation</legend>
                   
                    <input type="file" name="file" id="file" class="inputfile" />
                    <label for="file" class="button-secondary extra-margin">+ Upload</label>
                </div>
            </fieldset>

            <a href="#">Attach another file</a>

            <hr />

            <input type="hidden" id="action" name="action" th:value="${(queryType == 'query' ? 'postQuery' : 'saveNote')}" />

            <div class="grid-row">
                <div class="column-half"><button class="button button-large no-margin" th:text="${(queryType == 'query' ? 'Post Query' : 'Save note')}">Save note</button></div>
                <div class="column-half alignright"><a th:href="${#httpServletRequest.requestURI + '?action=cancelQuery'}">Cancel</a></div>
                
            </div>
        </form>

    </th:block>



    <th:block th:if="${param.action != null and param.action[0] == 'postQuery' or param.action != null and param.action[0] == 'showResponse' or param.action != null and param.action[0] == 'newResponse' or param.action != null and param.action[0] == 'postResponse'}" th:unless="${user == 'partner'}" >
        <th:block th:if="${queryType == 'query'}">
            
            <h2 class="heading-medium no-margin-bottom" th:utext="${#strings.replace( #strings.escapeXml( #httpServletRequest.getParameter('queryTitle') ),T(java.lang.System).getProperty('line.separator'),'&lt;br /&gt;')}">QUERY TITLE</h2>

            <h3 class="heading-small no-margin" th:text="${(param.section != null ? param.section[0] : 'NOT SET')}">SECTION TITLE</h3>
            
            <p class="heading-small no-margin-top">Innovate UK - Finance team <small>26/06/2016 17:55</small></p>

            <div th:utext="${#strings.replace( #strings.escapeXml( #httpServletRequest.getParameter('query') ),T(java.lang.System).getProperty('line.separator'),'&lt;br /&gt;')}">QUERY
            </div>

            <form method="get" th:action="${#httpServletRequest.requestURI}">
                <input type="hidden" id="queryTitle" name="queryTitle" th:value="${#httpServletRequest.getParameter('queryTitle')}" />
                <input type="hidden" id="section" name="section" th:value="${#httpServletRequest.getParameter('section')}" />
                <input type="hidden" id="query" name="query" th:value="${#httpServletRequest.getParameter('query')}" />
                <input type="hidden" id="action" name="action" value="showResponse" />
                <hr />
                <button>Show example response from the applicant</button>
            </form>
        </th:block>

        <!-- <th:block th:if="${queryType == 'note'}">
            <div class="panel-indent">
                <p class="heading-small no-margin-top">Francis Delt - Finance team <small>27/06/2015 09:40</small></p>
                <p>I think I have found the document (attached) showing that they have done this before.</p>

                <h4 class="heading-small">Supporting document</h4>
                <p><a href="#">Report1.doc</a></p>
            </div> 
        </th:block> -->

    </th:block>



  <!--  <th:block th:if="${param.action != null and param.action[0] == 'saveNote' or param.action != null and param.action[0] == 'newResponse'}" th:unless="${user == 'partner'}">
        
        <h2 class="heading-medium no-margin-bottom" th:utext="${#strings.replace( #strings.escapeXml( #httpServletRequest.getParameter('noteTitle') ),T(java.lang.System).getProperty('line.separator'),'&lt;br /&gt;')}" th:unless="${param.noteTitle == null}"></h2>

        <h2 class="heading-medium no-margin-bottom" th:unless="${param.noteTitle != null}">Administrative support costs</h2>

        <p class="heading-small">Paul Deldt ABC - Finance team <small>27/06/2015 09:40</small></p>

        <p th:utext="${#strings.replace( #strings.escapeXml( #httpServletRequest.getParameter('noteDetails') ),T(java.lang.System).getProperty('line.separator'),'&lt;br /&gt;')}" th:unless="${param.noteDetails == null}"></p>

        <p th:unless="${param.noteDetails != null}">Need to look into why the admin support costs are so high, surely they could be lower for a company of this type.</p>
        

    </th:block> -->

    <th:block th:if="${param.action != null and param.action[0] == 'showResponse' or param.action != null and param.action[0] == 'postResponse' or param.action != null and param.action[0] == 'Response' or param.action != null and param.action[0] == 'newResponse'}">

        <div class="panel-indent" th:unless="${queryType == 'note' or user == 'partner'}">
            <p><strong>Steve Smith - Aptrans Ltd </strong> <small th:text="${#dates.format(#dates.createNow(), 'dd MMM yyyy HH:mm')}">26/06/2016 18:23</small></p>
            <p>We have always used Francois. He is related to the director of the company. &pound;150k equates to 150 days.</p>
        </div>

    </th:block>

    <th:block th:if="${param.action != null and param.action[0] == 'saveNote' or param.action != null and param.action[0] == 'saveNote' or param.action != null and param.action[0] == 'newResponse' or param.action != null and param.action[0] == 'postResponse'}" th:unless="${queryType == 'query'}">
        <div class="extra-margin">

            <h2 class="heading-medium no-margin-top" th:utext="${#strings.replace( #strings.escapeXml( #httpServletRequest.getParameter('noteTitle') ),T(java.lang.System).getProperty('line.separator'),'&lt;br /&gt;')}" th:unless="${param.noteTitle == null}"></h2>

            <p class="heading-small no-margin">Paul Deldt - Finance team <small>27/06/2015 09:40</small></p>

            <p th:utext="${#strings.replace( #strings.escapeXml( #httpServletRequest.getParameter('noteDetails') ),T(java.lang.System).getProperty('line.separator'),'&lt;br /&gt;')}" th:unless="${param.noteDetails == null}"></p>

        </div>
    </th:block>


    <th:block th:if="${param.action != null and param.action[0] == 'showResponse' or param.action != null and param.action[0] == 'postResponse' or param.action != null and param.action[0] == 'Response'}">

        <div class="panel-indent" th:if="${param.action != null and param.action[0] == 'postResponse'}">
            
            <th:block th:if="${user == 'admin'}">
                <p class="no-margin"><strong>Innovate UK - Finance team </strong> <small th:text="${#dates.format(#dates.createNow(), 'dd MMM yyyy HH:mm')}">26/06/2016 18:23</small></p>
            </th:block>

            <th:block th:if="${user == 'partner'}">
                <p class="no-margin"><strong>Steve Smith - Aptrans Ltd </strong> <small th:text="${#dates.format(#dates.createNow(), 'dd MMM yyyy HH:mm')}">26/06/2016 18:23</small></p>
            </th:block>

            <div th:utext="${#strings.replace( #strings.escapeXml( #httpServletRequest.getParameter('response') ),T(java.lang.System).getProperty('line.separator'),'&lt;br /&gt;')}">
        </div>
            <h4 class="heading-small">Supporting document</h4>
            <p><a href="#">Report1.doc</a></p>
        </div>

        <form method="get" th:action="${#httpServletRequest.requestURI}" th:unless="${queryType == 'note'}">
            <input type="hidden" id="section" name="section" th:value="${#httpServletRequest.getParameter('section')}" />
            <input type="hidden" id="query" name="query" th:value="${#httpServletRequest.getParameter('query')}" />
            <input type="hidden" id="queryTitle" name="queryTitle" th:value="${#httpServletRequest.getParameter('queryTitle')}" />
            <input type="hidden" id="action" name="action" value="newResponse" />
            <hr />
            <button class="button button-secondary">Respond</button>
        </form>

    </th:block>


    <th:block th:if="${param.action != null and param.action[0] == 'newResponse'}">
    
        <form class="extra-margin" th:action="@{${#httpServletRequest.requestURI}}" method="get">

            <fieldset>
                
                <legend class="heading-medium" th:text="${(queryType == 'query' ? 'Respond to query' : 'Comment')}">RESPOND TITLE</legend>

                <div class="form-group">
                    <label for="response" class="form-label-bold" th:text="${(queryType == 'query' ? 'Response' : 'Add your comment')}">RESPONSE LABEL</label>
                    <textarea name="response" id="response" cols="30" rows="10" class="width-full" required="required"></textarea>
                    <div class="count-label alignright">
                        <small>
                            <span class="count-message">Words remaining:</span>
                            <span class="count-down positive" aria-live="polite">400</span>
                        </small>
                    </div>
                </div>

            </fieldset>

            <fieldset>
                <div class="upload-section unstyled-view">
                    <legend class="heading-small no-margin">Upload supporting documentation</legend>
                
                    <input type="file" name="file" id="file" class="inputfile" />
                    <label for="file" class="button-secondary extra-margin">+ Upload</label>
                </div>
            </fieldset>

            <th:block th:if="${queryType == 'query'}">
                <input type="hidden" id="section" name="section" th:value="${#httpServletRequest.getParameter('section')}" />
                <input type="hidden" id="query" name="query" th:value="${#httpServletRequest.getParameter('query')}" />
                <input type="hidden" id="queryTitle" name="queryTitle" th:value="${#httpServletRequest.getParameter('queryTitle')}" />
            </th:block>
            
            <th:block th:if="${queryType == 'note'}">
                <input type="hidden" id="noteTitle" name="noteTitle" th:value="${#httpServletRequest.getParameter('noteTitle')}" />
                <input type="hidden" id="noteDetails" name="noteDetails" th:value="${#httpServletRequest.getParameter('noteDetails')}" />
            </th:block>


            <input type="hidden" id="action" name="action" value="postResponse" />  

            <div class="grid-row extra-margin">
                <div class="column-half"><button class="button button-large no-margin" th:text="${(queryType == 'query' ? 'Post response' : 'Save comment')}">Post response</button></div>
                <div class="column-half alignright"><a th:href="${#httpServletRequest.requestURI}">Cancel</a></div>
                
            </div>
        </form>

    </th:block>

    <th:block th:if="${queryType == 'note' and param.action != null and param.action[0] == 'saveNote'}">

        <form method="get" th:action="${#httpServletRequest.requestURI}">
            <input type="hidden" id="noteTitle" name="noteTitle" th:value="${#httpServletRequest.getParameter('noteTitle')}" />
            <input type="hidden" id="noteDetails" name="noteDetails" th:value="${#httpServletRequest.getParameter('noteDetails')}" />
            <input type="hidden" id="action" name="action" value="newResponse" />
            <hr />
            <button class="button button-secondary">Comment</button>
        </form>

    </th:block>

</div>

</html>