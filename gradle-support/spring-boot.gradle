apply from: rootProject.file("gradle-support/java.gradle")

apply plugin: 'io.spring.dependency-management'
apply plugin: 'org.springframework.boot'

dependencies {

    // Enforced platform is composite of IFS libraries, spring boot and spring cloud
    implementation enforcedPlatform (project(':common:bom'))

    developmentOnly("org.springframework.boot:spring-boot-devtools")
    developmentOnly project(":common:starter:ifs-starter-stubdev")

    implementation "org.springframework.boot:spring-boot-starter-actuator"
    implementation "org.springframework.boot:spring-boot-starter-web"
    implementation project(":common:starter:ifs-starter-logging")

    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

bootJar {
    classifier = 'executable'
    mainClassName = 'org.innovateuk.ifs.Application'
}

springBoot {
    buildInfo {
        properties {
            additional = [
                    'buildNumber': java.util.Optional.ofNullable(System.getenv("bamboo_buildNumber")).orElse("[not available]"),
                    'gitCommitId': java.util.Optional.ofNullable(System.getenv("bamboo_planRepository_revision")).orElse("[not available]"),
                    'gitBranch': java.util.Optional.ofNullable(System.getenv("bamboo_planRepository_branchName")).orElse("[not available]")
            ]
        }
    }
}

